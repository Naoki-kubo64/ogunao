<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯¾æˆ¦ãƒœã‚¿ãƒ³ä¸¡è„‡ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒ†ã‚¹ãƒˆ</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* ãƒ†ã‚¹ãƒˆç”¨ã®è¿½åŠ ã‚¹ã‚¿ã‚¤ãƒ« */
        .test-container {
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 20px;
        }
        
        .test-info {
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-family: monospace;
        }
        
        .highlight-area {
            border: 3px dashed #00ff00;
            background: rgba(0, 255, 0, 0.1);
            padding: 5px;
            margin: 5px;
            border-radius: 5px;
        }
        
        .demo-puyo {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: inline-block;
            margin: 2px;
            vertical-align: middle;
        }
        
        .puyo-red { background: #ff4444; }
        .puyo-green { background: #44ff44; }
        .puyo-blue { background: #4444ff; }
        .puyo-yellow { background: #ffff44; }
        .puyo-purple { background: #ff44ff; }
    </style>
</head>
<body>
    <div class="container">
        <div class="test-container">
            <h1>âš”ï¸ å¯¾æˆ¦ãƒœã‚¿ãƒ³ä¸¡è„‡ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒ†ã‚¹ãƒˆ</h1>
            <div class="test-info">
                <h3>ğŸ“‹ å¤‰æ›´å†…å®¹ç¢ºèª</h3>
                <div>âœ… æ¬¡ã®ã·ã‚ˆè¡¨ç¤ºã‚’å¯¾æˆ¦é–‹å§‹ãƒœã‚¿ãƒ³ã®ä¸¡è„‡ã«é…ç½®</div>
                <div>âœ… CPUå´: ãƒœã‚¿ãƒ³ã®å·¦å´</div>
                <div>âœ… ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼å´: ãƒœã‚¿ãƒ³ã®å³å´</div>
                <div>âœ… ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ: ãƒ¢ãƒã‚¤ãƒ«ã§ã¯ç¸¦ä¸¦ã³</div>
            </div>
        </div>
        
        <div class="game-area">
            <div class="game-status">
                <!-- å¯¾æˆ¦ãƒ¢ãƒ¼ãƒ‰ç”»é¢ -->
                <div id="battle-screen" class="battle-screen">
                    <div class="battle-content">
                        <div class="battle-header">
                            <h2 class="battle-title">âš”ï¸ CPUå¯¾æˆ¦ãƒ¢ãƒ¼ãƒ‰ - ãƒœã‚¿ãƒ³ä¸¡è„‡ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ</h2>
                            <button onclick="toggleHighlight()" class="back-button">ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒã‚¤ãƒ©ã‚¤ãƒˆ</button>
                        </div>
                        
                        <div class="battle-arena">
                            <!-- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼å´ -->
                            <div class="player-side">
                                <div class="player-info">
                                    <h3 class="player-name">ã‚ãªãŸ</h3>
                                    <div class="player-score">ã‚¹ã‚³ã‚¢: <span id="player-score">15,400</span></div>
                                </div>
                                <div class="player-board">
                                    <canvas id="player-canvas" width="300" height="600" style="background: rgba(0,0,0,0.5); border: 2px solid #ffa500;"></canvas>
                                </div>
                            </div>
                            
                            <!-- VSè¡¨ç¤º -->
                            <div class="vs-display">
                                <div class="vs-text">VS</div>
                                <div class="battle-status">
                                    <div id="battle-timer">æ®‹ã‚Šæ™‚é–“: <span id="time-left">127</span>ç§’</div>
                                    <div class="battle-controls-with-next" id="main-layout">
                                        <!-- CPUå´ã®æ¬¡ã®ã·ã‚ˆè¡¨ç¤ºï¼ˆå·¦å´ï¼‰ -->
                                        <div class="cpu-next-outside" id="cpu-next-area">
                                            <div class="next-label">CPUã®æ¬¡ã®ã·ã‚ˆ</div>
                                            <div id="cpu-next-puyo">
                                                <!-- ãƒ‡ãƒ¢ç”¨ã®ã·ã‚ˆ -->
                                                <div class="demo-puyo puyo-red"></div>
                                                <div class="demo-puyo puyo-blue"></div>
                                            </div>
                                        </div>
                                        
                                        <!-- å¯¾æˆ¦ãƒœã‚¿ãƒ³ -->
                                        <div class="battle-buttons" id="button-area">
                                            <button id="battle-start" class="battle-start-btn">å¯¾æˆ¦é–‹å§‹</button>
                                            <button id="battle-pause" class="battle-pause-btn hidden">ä¸€æ™‚åœæ­¢</button>
                                        </div>
                                        
                                        <!-- ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼å´ã®æ¬¡ã®ã·ã‚ˆè¡¨ç¤ºï¼ˆå³å´ï¼‰ -->
                                        <div class="player-next-outside" id="player-next-area">
                                            <div class="next-label">ã‚ãªãŸã®æ¬¡ã®ã·ã‚ˆ</div>
                                            <div id="player-next-puyo">
                                                <!-- ãƒ‡ãƒ¢ç”¨ã®ã·ã‚ˆ -->
                                                <div class="demo-puyo puyo-green"></div>
                                                <div class="demo-puyo puyo-yellow"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- CPUå´ -->
                            <div class="cpu-side">
                                <div class="cpu-info">
                                    <h3 class="cpu-name">CPU</h3>
                                    <div class="cpu-score">ã‚¹ã‚³ã‚¢: <span id="cpu-score">11,750</span></div>
                                </div>
                                <div class="cpu-board">
                                    <canvas id="cpu-canvas" width="300" height="600" style="background: rgba(0,0,0,0.5); border: 2px solid #ffa500;"></canvas>
                                </div>
                            </div>
                        </div>
                        
                        <div class="battle-controls">
                            <div class="control-info">
                                <h4>ğŸ”§ ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒ†ã‚¹ãƒˆæ©Ÿèƒ½</h4>
                                <div class="controls-grid">
                                    <button onclick="testLayout()">ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè¨ˆæ¸¬</button>
                                    <button onclick="swapPuyos()">ã·ã‚ˆå…¥ã‚Œæ›¿ãˆ</button>
                                    <button onclick="testMobileView()">ãƒ¢ãƒã‚¤ãƒ«è¡¨ç¤º</button>
                                    <button onclick="resetView()">è¡¨ç¤ºãƒªã‚»ãƒƒãƒˆ</button>
                                </div>
                            </div>
                            <div class="battle-settings">
                                <label>ã·ã‚ˆè¡¨ç¤º:</label>
                                <select id="puyo-style" onchange="changePuyoStyle()">
                                    <option value="round">ä¸¸å‹</option>
                                    <option value="square">å››è§’å‹</option>
                                    <option value="large">å¤§ãã‚</option>
                                    <option value="small">å°ã•ã‚</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="test-container">
            <div class="test-info">
                <h3>ğŸ“Š ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆç¢ºèªçµæœ</h3>
                <div id="layout-results">
                    <div>ğŸ“ å…¨ä½“å¹…: <span id="total-width">è¨ˆæ¸¬å¾…ã¡</span></div>
                    <div>ğŸ® CPUå´ä½ç½®: <span id="cpu-position">è¨ˆæ¸¬å¾…ã¡</span></div>
                    <div>ğŸ”˜ ãƒœã‚¿ãƒ³ä½ç½®: <span id="button-position">è¨ˆæ¸¬å¾…ã¡</span></div>
                    <div>ğŸ‘¤ ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼å´ä½ç½®: <span id="player-position">è¨ˆæ¸¬å¾…ã¡</span></div>
                    <div>ğŸ“± é…ç½®é †åº: <span id="layout-order">è¨ˆæ¸¬å¾…ã¡</span></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let highlightMode = false;
        let currentPuyoColors = ['red', 'blue', 'green', 'yellow', 'purple'];
        let colorIndex = 0;
        
        function toggleHighlight() {
            highlightMode = !highlightMode;
            const areas = ['cpu-next-area', 'button-area', 'player-next-area'];
            
            areas.forEach(id => {
                const element = document.getElementById(id);
                if (highlightMode) {
                    element.classList.add('highlight-area');
                } else {
                    element.classList.remove('highlight-area');
                }
            });
            
            console.log('ãƒã‚¤ãƒ©ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰:', highlightMode ? 'ON' : 'OFF');
        }
        
        function testLayout() {
            const mainLayout = document.getElementById('main-layout');
            const cpuArea = document.getElementById('cpu-next-area');
            const buttonArea = document.getElementById('button-area');
            const playerArea = document.getElementById('player-next-area');
            
            const mainRect = mainLayout.getBoundingClientRect();
            const cpuRect = cpuArea.getBoundingClientRect();
            const buttonRect = buttonArea.getBoundingClientRect();
            const playerRect = playerArea.getBoundingClientRect();
            
            // çµæœã‚’è¡¨ç¤º
            document.getElementById('total-width').textContent = `${Math.round(mainRect.width)}px`;
            document.getElementById('cpu-position').textContent = 
                `å·¦ã‹ã‚‰${Math.round(cpuRect.left - mainRect.left)}px (å¹…: ${Math.round(cpuRect.width)}px)`;
            document.getElementById('button-position').textContent = 
                `å·¦ã‹ã‚‰${Math.round(buttonRect.left - mainRect.left)}px (å¹…: ${Math.round(buttonRect.width)}px)`;
            document.getElementById('player-position').textContent = 
                `å·¦ã‹ã‚‰${Math.round(playerRect.left - mainRect.left)}px (å¹…: ${Math.round(playerRect.width)}px)`;
            
            // é…ç½®é †åºã®ç¢ºèª
            const isCorrectOrder = cpuRect.left < buttonRect.left && buttonRect.left < playerRect.left;
            document.getElementById('layout-order').textContent = 
                isCorrectOrder ? 'âœ… CPU â†’ ãƒœã‚¿ãƒ³ â†’ ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼' : 'âŒ é †åºã«å•é¡Œã‚ã‚Š';
            
            console.log('ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè¨ˆæ¸¬å®Œäº†:', {
                cpu: cpuRect,
                button: buttonRect,
                player: playerRect
            });
        }
        
        function swapPuyos() {
            const cpuPuyos = document.querySelectorAll('#cpu-next-puyo .demo-puyo');
            const playerPuyos = document.querySelectorAll('#player-next-puyo .demo-puyo');
            
            // ãƒ©ãƒ³ãƒ€ãƒ ãªè‰²ã«å¤‰æ›´
            cpuPuyos.forEach(puyo => {
                puyo.className = `demo-puyo puyo-${currentPuyoColors[colorIndex % currentPuyoColors.length]}`;
                colorIndex++;
            });
            
            playerPuyos.forEach(puyo => {
                puyo.className = `demo-puyo puyo-${currentPuyoColors[colorIndex % currentPuyoColors.length]}`;
                colorIndex++;
            });
            
            console.log('ã·ã‚ˆã®è‰²ã‚’å¤‰æ›´ã—ã¾ã—ãŸ');
        }
        
        function testMobileView() {
            const container = document.querySelector('.container');
            const currentWidth = container.style.maxWidth;
            
            if (currentWidth === '768px') {
                container.style.maxWidth = 'none';
                console.log('ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—è¡¨ç¤ºã«æˆ»ã—ã¾ã—ãŸ');
            } else {
                container.style.maxWidth = '768px';
                console.log('ãƒ¢ãƒã‚¤ãƒ«è¡¨ç¤ºã«åˆ‡ã‚Šæ›¿ãˆã¾ã—ãŸ');
            }
            
            setTimeout(testLayout, 200);
        }
        
        function resetView() {
            const container = document.querySelector('.container');
            container.style.maxWidth = 'none';
            
            // ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’è§£é™¤
            if (highlightMode) {
                toggleHighlight();
            }
            
            console.log('è¡¨ç¤ºã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã—ãŸ');
            setTimeout(testLayout, 200);
        }
        
        function changePuyoStyle() {
            const selector = document.getElementById('puyo-style');
            const puyos = document.querySelectorAll('.demo-puyo');
            
            puyos.forEach(puyo => {
                puyo.style.borderRadius = '';
                puyo.style.width = '';
                puyo.style.height = '';
                
                switch(selector.value) {
                    case 'square':
                        puyo.style.borderRadius = '3px';
                        break;
                    case 'large':
                        puyo.style.width = '40px';
                        puyo.style.height = '40px';
                        break;
                    case 'small':
                        puyo.style.width = '25px';
                        puyo.style.height = '25px';
                        break;
                }
            });
            
            console.log('ã·ã‚ˆã‚¹ã‚¿ã‚¤ãƒ«å¤‰æ›´:', selector.value);
        }
        
        // åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸš€ å¯¾æˆ¦ãƒœã‚¿ãƒ³ä¸¡è„‡ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒ†ã‚¹ãƒˆåˆæœŸåŒ–å®Œäº†');
            
            // è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
            setTimeout(() => {
                testLayout();
            }, 500);
        });
        
        // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒªã‚µã‚¤ã‚ºæ™‚ã®è‡ªå‹•å†è¨ˆæ¸¬
        window.addEventListener('resize', () => {
            setTimeout(testLayout, 200);
        });
    </script>
</body>
</html>